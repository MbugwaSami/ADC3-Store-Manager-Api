import os
import psycopg2
from flask import Flask

from instance.config import app_config

ENVIRONMENT = os.environment['ENV']
app_config[ENVIRONMENT].CONNECTION_STRING
class DbBase(object):
	"""This Class has the setup for connecting to the database and creation of tables """


	def connection(self):
		"""This method creates a connection to the class"""
		conn = psycopg2.connect(app_config[ENVIRONMENT].connectionVariables)
		return conn

	def createTables(self):

		conn = self.connection()
		cur=conn.cursor()

		query1 = ""CREATE TABLE if not EXISTS users(
            user_id integer PRIMARY KEY NOT NULL,
            names varchar(40) NOT NULL,
            email varchar(100) NOT NULL,
            role varchar(15) NOT NULL,       
		)""

		query2 = ""CREATE TABLE if not EXISTS products(
            product_id integer PRIMARY KEY NOT NULL,
            product_name varchar(20) UNIQUE NOT NULL,
            description varchar(20) NOT NULL,
            price integer NOT NULL,
            min_stock integer NOT NULL,
            stock integer NOT NULL,
            category varchar(20),
		)""


		query3 = ""CREATE TABLE if not EXISTS sales(
            sale_id integer PRIMARY KEY NOT NULL,
            items varchar(20) NOT NULL,
            item_count integer NOT NULL,
            price integer NOT NULL,
            user_id varchar(20) NOT NULL,
            date_created timestamp,       
		)""	

		queries=[query1,query2,query3]

		for query in queries:

			cur.execute(query)

        conn.commit()
        conn.close()			
















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































				


	
		
		














































